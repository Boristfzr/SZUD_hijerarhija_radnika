#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define MAX_NAME_LENGTH 100

typedef struct Radnik {
    char ime[MAX_NAME_LENGTH];  
    struct Radnik* menadzer;   
    struct Radnik* podredjeni;  
    struct Radnik* sledeci;     
} Radnik;

Radnik* kreiraj_radnika(const char* ime) {
    Radnik* r = (Radnik*)malloc(sizeof(Radnik));
    strncpy(r->ime, ime, MAX_NAME_LENGTH);
    r->menadzer = NULL;
    r->podredjeni = NULL;
    r->sledeci = NULL;
    return r;
}

Radnik* pronadji_radnika(Radnik* radnik, const char* ime) {
    if (radnik == NULL) return NULL;
    if (strcmp(radnik->ime, ime) == 0) return radnik;
    
    Radnik* pronadjen = pronadji_radnika(radnik->podredjeni, ime);
    if (pronadjen != NULL) return pronadjen;
    
    return pronadji_radnika(radnik->sledeci, ime);
}



void dodaj_radnika(Radnik* menadzer) {
    char ime[MAX_NAME_LENGTH];
    printf("Unesite ime novog radnika: ");
    scanf(" %[^\n]", ime);
    Radnik* novi_radnik = kreiraj_radnika(ime);
    dodaj_podredjenog(menadzer, novi_radnik);
}


void ispis_hijerarhije(Radnik* radnik, int nivo) {
    if (radnik == NULL) return;

    for (int i = 0; i < nivo; i++) {
        printf("  ");
    }
    printf("%s\n", radnik->ime);

    ispis_hijerarhije(radnik->podredjeni, nivo + 1);
    
    ispis_hijerarhije(radnik->sledeci, nivo);
}

int main() {
    Radnik* direktor = novi_radnik("Direktor");
    Radnik* menadzer1 = novi_radnik("Menadžer 1");
    Radnik* menadzer2 = novi_radnik("Menadžer 2");
    Radnik* zaposleni1 = novi_radnik("Zaposleni 1");
    Radnik* zaposleni2 = novi_radnik("Zaposleni 2");
    Radnik* zaposleni3 = novi_radnik("Zaposleni 3");

    dodaj_podredjenog(direktor, menadzer1);
    dodaj_podredjenog(direktor, menadzer2);
    
    dodaj_podredjenog(menadzer1, zaposleni1);
    dodaj_podredjenog(menadzer1, zaposleni2);
    dodaj_podredjenog(menadzer2, zaposleni3);
    

    int izbor;
    char ime[MAX_NAME_LENGTH];

        while (1) {
        printf("\n===== GLAVNI MENI =====\n");
        printf("[1] Ispis firme\n");
        printf("[2] Novi zaposleni\n");
        printf("[3] Obrisi zaposlenog\n");
        printf("[0] Kraj programa\n");
        printf("Vas izbor: ");
        scanf("%d", &izbor);
        getchar();

        switch (izbor) {
            case 1:
                printf("\nHijerarhija firme:\n");
                ispis_hijerarhije(direktor, 0);
                break;

            case 2:
                printf("\nUnesite ime menadžera: ");
                scanf(" %[^\n]", ime);

                Radnik* menadzer = pronadji_radnika(direktor, ime);
                if (menadzer != NULL) {
                    dodaj_radnika(menadzer);
                } else {
                    printf("Menadžer nije pronađen.\n");
                }
                break;

            case 3:
                printf("\nUnesite ime radnika za uklanjanje: ");
                scanf(" %[^\n]", ime);

                if (!ukloni_radnika(direktor, ime)) {
                    printf("Radnik nije pronađen.\n");
                }
                break;

            case 4:
                printf("Izlaz iz programa.\n");
                break;

            default:
                printf("Neispravan izbor!\n");
        }
    } while (izbor != 4);

     free(direktor);

         return 0;
}