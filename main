#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define MAX_NAME_LENGTH 100

typedef struct Radnik {
    char ime[MAX_NAME_LENGTH];  
    struct Radnik* menadzer;   
    struct Radnik* podredjeni;  
    struct Radnik* sledeci;     
} Radnik;

Radnik* kreiraj_radnika(const char* ime) {
    Radnik* r = (Radnik*)malloc(sizeof(Radnik));
    strncpy(r->ime, ime, MAX_NAME_LENGTH);
    r->menadzer = NULL;
    r->podredjeni = NULL;
    r->sledeci = NULL;
    return r;
}

Radnik* pronadji_radnika(Radnik* radnik, const char* ime) {
    if (radnik == NULL) return NULL;
    if (strcmp(radnik->ime, ime) == 0) return radnik;
    
    Radnik* pronadjen = pronadji_radnika(radnik->podredjeni, ime);
    if (pronadjen != NULL) return pronadjen;
    
    return pronadji_radnika(radnik->sledeci, ime);
}



void dodaj_radnika(Radnik* menadzer) {
    char ime[MAX_NAME_LENGTH];
    printf("Unesite ime novog radnika: ");
    printf("Unesite ime novog radnika (npr. 'Jelena - Zaposleni'): ");
    scanf(" %[^\n]", ime); // čita ceo red sa razmacima

    const char* suffix = " - Zaposleni";
    int ime_len = strlen(ime);
    int suffix_len = strlen(suffix);

    if (ime_len >= suffix_len && strcmp(ime + ime_len - suffix_len, suffix) == 0) {
        Radnik* novi_radnik = kreiraj_radnika(ime);
        dodaj_podredjenog(menadzer, novi_radnik);
        printf("Radnik je uspešno dodat.\n");
    } else {
        printf("Neispravan format imena! Radnik mora imati sufiks '- Zaposleni'.\n");
    }
}


void ispis_hijerarhije(Radnik* radnik, int nivo) {
    if (radnik == NULL) return;

    for (int i = 0; i < nivo; i++) {
        printf("  ");
    }
    printf("%s\n", radnik->ime);

    ispis_hijerarhije(radnik->podredjeni, nivo + 1);
    
    ispis_hijerarhije(radnik->sledeci, nivo);
}

int main() {
    Radnik* direktor = kreiraj_radnika("Zoran - Direktor");
    Radnik* menadzer1 = kreiraj_radnika("Dragan - Menadžer");
    Radnik* menadzer2 = kreiraj_radnika("Ljubica - Menadžer");
    Radnik* zaposleni1 = kreiraj_radnika("Radoslav - Zaposleni");
    Radnik* zaposleni2 = kreiraj_radnika("Boris - Zaposleni");
    Radnik* zaposleni3 = kreiraj_radnika("Marko - Zaposleni");

    dodaj_podredjenog(direktor, menadzer1);
    
    dodaj_podredjenog(menadzer1, zaposleni1);
    dodaj_podredjenog(menadzer1, zaposleni2);
    dodaj_podredjenog(menadzer2, zaposleni3);
    

    printf("Unesite ime radnika za pretragu: ");
    char ime[MAX_NAME_LENGTH];
    scanf("%s", ime);

    
    Radnik* radnik = pronadji_radnika(direktor, ime);
    if (radnik != NULL) {
        printf("Radnik %s je pronađen\n", ime);
    } else {
        printf("Radnik nije pronađen\n");


     printf("\nUnesite ime menadžera pod kojim želite da dodate novog radnika: ");
    char ime_menadzera[MAX_NAME_LENGTH];
    scanf("%s", ime_menadzera);

    Radnik* menadzer = pronadji_radnika(direktor, ime_menadzera);
    if (menadzer != NULL) {
        dodaj_radnika(menadzer);
        printf("\nAžurirana hijerarhija:\n");
        ispis_hijerarhije(direktor, 0);
    } else {
        printf("Menadžer sa imenom %s nije pronađen.\n", ime_menadzera);
    }


    free(direktor);
    free(menadzer1);
    free(menadzer2);
    free(zaposleni1);
    free(zaposleni2);
    free(zaposleni3);
}

    return 0;
